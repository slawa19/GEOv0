# GEO Protocol: Ключевые концепции

**Версия:** 0.1  
**Дата:** Ноябрь 2025

---

## Содержание

1. [Участник (Participant)](#1-участник-participant)
2. [Эквивалент (Equivalent)](#2-эквивалент-equivalent)
3. [Линия доверия (TrustLine)](#3-линия-доверия-trustline)
4. [Долг (Debt)](#4-долг-debt)
5. [Платёж (Payment)](#5-платёж-payment)
6. [Клиринг (Clearing)](#6-клиринг-clearing)
7. [Транзакция (Transaction)](#7-транзакция-transaction)
8. [Hub и координация](#8-hub-и-координация)

---

## 1. Участник (Participant)

**Участник** — это любая сущность, которая может участвовать в экономике GEO:
- Физическое лицо
- Организация или бизнес
- Hub (узел сообщества — тоже участник на уровне федерации)

### Идентичность

Каждый участник идентифицируется криптографически:

```
PID = base58(sha256(public_key))
```

- **public_key** — публичный ключ Ed25519 (32 байта)
- **PID** — производный идентификатор участника

### Свойства участника

| Поле | Описание |
|------|----------|
| `pid` | Уникальный идентификатор (производный от pubkey) |
| `public_key` | Публичный ключ Ed25519 |
| `display_name` | Человекочитаемое имя |
| `profile` | Метаданные (тип, контакты, описание) |
| `status` | `active`, `suspended`, `left`, `deleted` |
| `verification_level` | Уровень верификации (зависит от сообщества) |

### Принцип владения

- Приватный ключ **никогда не передаётся** на сервер
- Все критические операции **подписываются** владельцем ключа
- Hub хранит только публичные ключи и проверяет подписи

---

## 2. Эквивалент (Equivalent)

**Эквивалент** — это единица счёта, в которой измеряются обязательства.

### Примеры эквивалентов

| Код | Описание | Precision |
|-----|----------|-----------|
| `UAH` | Украинская гривна | 2 |
| `USD` | Доллар США | 2 |
| `HOUR` | Час работы | 2 |
| `HOUR_DEV` | Час работы разработчика | 2 |
| `kWh` | Киловатт-час | 3 |
| `LOCAL` | Внутренняя единица сообщества | 2 |

### Свойства эквивалента

| Поле | Описание |
|------|----------|
| `code` | Уникальный строковый код |
| `precision` | Количество знаков после запятой |
| `description` | Человекочитаемое описание |
| `metadata` | Дополнительные данные (тип, привязка) |

### Важно

- В системе **нет валюты по умолчанию**
- Все операции явно указывают эквивалент
- GEO **не конвертирует** между эквивалентами автоматически
- Один участник может иметь линии доверия в разных эквивалентах

---

## 3. Линия доверия (TrustLine)

**Линия доверия** — это декларация одного участника о готовности принять риск на другого.

### Семантика

```
TrustLine: A → B (limit=1000, equivalent=UAH)
```

Означает: **«A разрешает B быть должным ему до 1000 UAH»**

### Ключевые свойства

| Свойство | Описание |
|----------|----------|
| **Направленность** | A→B ≠ B→A (это разные линии) |
| **Односторонность** | Создаётся владельцем (A) без согласия B |
| **Ограниченность** | Задаёт максимальный долг B перед A |
| **Специфичность** | Привязана к конкретному эквиваленту |

### Структура TrustLine

| Поле | Описание |
|------|----------|
| `from` | PID того, кто даёт доверие (кредитор) |
| `to` | PID того, кому доверяют (потенциальный должник) |
| `equivalent` | Эквивалент |
| `limit` | Максимальная сумма долга |
| `policy` | Политики (авто-клиринг, ограничения маршрутов) |
| `status` | `active`, `frozen`, `closed` |

### Базовый инвариант

```
debt[B→A, E] ≤ limit(A→B, E)
```

Долг B перед A не может превышать установленный лимит.

### Пример

```
Алиса создаёт TrustLine: Алиса → Боб (limit=500, UAH)

Это означает:
- Боб может быть должен Алисе до 500 UAH
- Алиса несёт риск невозврата
- Боб может использовать это доверие для покупок
```

---

## 4. Долг (Debt)

**Долг** — это фактическое обязательство одного участника перед другим.

### Семантика

```
Debt: X → Y (amount=300, equivalent=UAH)
```

Означает: **«X должен Y 300 UAH»**

### Структура Debt

| Поле | Описание |
|------|----------|
| `debtor` | PID должника |
| `creditor` | PID кредитора |
| `equivalent` | Эквивалент |
| `amount` | Текущая сумма долга (> 0) |

### Связь с TrustLine

- TrustLine задаёт **потолок** возможного долга
- Debt — это **фактическое состояние**
- Один TrustLine может «обслуживать» множество транзакций

### Агрегация

- Для каждой тройки `(debtor, creditor, equivalent)` хранится **одна агрегированная запись**
- Протокол не хранит историю каждой сделки — только итоговый долг
- История фиксируется в транзакциях

---

## 5. Платёж (Payment)

**Платёж** — это перемещение «стоимости» от плательщика к получателю через сеть доверия.

### Как работает платёж

```
A хочет заплатить C 100 UAH
Прямой TrustLine A→C отсутствует

Но есть цепочка:
A → B (limit=200) → C (limit=150)

Платёж идёт по цепочке:
1. A становится должен B +100
2. B становится должен C +100
3. C получил "оплату" от A
```

### Доступный кредит (Available Credit)

Для каждого направленного ребра:

```
available_credit(A→B, E) = limit(A→B, E) - debt[B→A, E]
```

Это максимум, который можно «провести» по данному ребру.

### Маршрутизация

1. **Поиск путей**: BFS с ограничением глубины (до 6 звеньев)
2. **Расчёт ёмкости**: min(available_credit) по всем рёбрам пути
3. **Multi-path**: разбиение платежа на 2–3 маршрута при необходимости

### Пример multi-path

```
A → C на 100 UAH

Найдены пути:
- A → X → C (ёмкость 60)
- A → Y → Z → C (ёмкость 50)

Платёж разбивается:
- 60 через путь 1
- 40 через путь 2
```

---

## 6. Клиринг (Clearing)

**Клиринг** — это автоматический взаимозачёт долгов в замкнутом цикле.

### Пример цикла

```
A должен B: 100
B должен C: 100
C должен A: 100

Это замкнутый цикл. Экономически — никто никому не должен.

Клиринг уменьшает все долги на min(100, 100, 100) = 100:
A должен B: 0
B должен C: 0
C должен A: 0
```

### Как это работает

1. **Поиск циклов**: Алгоритм находит замкнутые цепочки долгов
2. **Расчёт суммы**: S = min(долг по каждому ребру цикла)
3. **Применение**: Уменьшение всех долгов на S

### Длина циклов

| Длина | Частота поиска | Сложность |
|-------|----------------|-----------|
| 3 узла | После каждой транзакции | Низкая |
| 4 узла | После каждой транзакции | Низкая |
| 5 узлов | Периодически (раз в час) | Средняя |
| 6 узлов | Периодически (раз в сутки) | Высокая |

### Зачем нужен клиринг

- **Освобождает лимиты**: После клиринга TrustLines снова доступны
- **Уменьшает риски**: Меньше «висящих» долгов в системе
- **Повышает ликвидность**: Больше возможных маршрутов для платежей

---

## 7. Транзакция (Transaction)

**Транзакция** — это атомарная единица изменений в системе.

### Типы транзакций

| Тип | Описание |
|-----|----------|
| `TRUST_LINE_CREATE` | Создание линии доверия |
| `TRUST_LINE_UPDATE` | Изменение лимита или политики |
| `TRUST_LINE_CLOSE` | Закрытие линии |
| `PAYMENT` | Платёж через сеть |
| `CLEARING` | Взаимозачёт по циклу |

### Структура транзакции

| Поле | Описание |
|------|----------|
| `tx_id` | Уникальный идентификатор (UUID или hash) |
| `type` | Тип транзакции |
| `initiator` | PID инициатора |
| `payload` | Типизированные данные операции |
| `signatures` | Подписи участников |
| `state` | Текущее состояние |
| `created_at` | Время создания |

### Состояния PAYMENT

```
NEW → ROUTED → PREPARE_IN_PROGRESS → COMMITTED
                                   ↘ ABORTED
```

### Состояния CLEARING

```
NEW → PROPOSED → WAITING_CONFIRMATIONS → COMMITTED
                                       ↘ REJECTED
```

### Идемпотентность

- Повторный `COMMIT` по уже завершённой транзакции — безопасен
- `tx_id` гарантирует отсутствие дубликатов

---

## 8. Hub и координация

### Роль Hub'а

Hub выполняет функции **координатора**, но не является банком:

| Функция | Описание |
|---------|----------|
| **Хранение** | Состояние участников, TrustLines, долгов |
| **Координация** | Фазы PREPARE/COMMIT транзакций |
| **Маршрутизация** | Поиск путей для платежей |
| **Клиринг** | Поиск и исполнение циклов |
| **API** | Доступ для клиентов |

### Чего Hub НЕ делает

- Не хранит приватные ключи участников
- Не совершает операции без подписи владельца
- Не «владеет» средствами участников
- Не принимает односторонних решений о балансах

### Координация транзакций (2PC)

**Двухфазный коммит** гарантирует атомарность:

```
Фаза 1: PREPARE
- Hub отправляет всем участникам запрос на резервирование
- Каждый проверяет условия и резервирует ресурсы
- Все отвечают OK или FAIL

Фаза 2: COMMIT или ABORT
- Если все OK → COMMIT (применение изменений)
- Если кто-то FAIL → ABORT (освобождение резервов)
```

### Администрирование Hub'а

Hub управляется **оператором сообщества** (кооператив, НКО, и т.п.):

| Роль | Права |
|------|-------|
| `admin` | Управление конфигурацией, ролями, аддонами |
| `operator` | Мониторинг, помощь пользователям, разбор споров |
| `auditor` | Только чтение логов и отчётов |

### Федерация Hub'ов

Hub'ы разных сообществ могут объединяться:

```
┌───────────────┐         ┌───────────────┐
│  Community A  │         │  Community B  │
│  ┌─────────┐  │ Trust-  │  ┌─────────┐  │
│  │ Hub A   │◄─┼─Line────┼─►│ Hub B   │  │
│  └────┬────┘  │         │  └────┬────┘  │
│  [users A]    │         │  [users B]    │
└───────────────┘         └───────────────┘

Hub A и Hub B — обычные участники протокола
Между ними открыты TrustLines
Платежи между сообществами маршрутизируются через Hub'ы
```

---

---

## 9. Экономическая модель

### 9.1. Скрытый демередж (Implicit Demurrage)

В отличие от явного демереджа (налог на накопление денег), GEO создаёт **скрытый демередж** через саму структуру системы.

**Что такое демередж?**

Демередж — это механизм, который делает хранение денег «дорогим». В традиционных системах это может быть явный налог (например, -2% в месяц на балансы). В GEO демередж **скрытый** — он возникает естественно из структуры системы.

**Почему в GEO нельзя «накопить богатство»?**

В GEO нет денег как таковых — есть только обязательства (долги) между участниками. «Богатство» в GEO означает, что тебе много должны. Но чтобы тебе могли быть должны, кто-то должен открыть TrustLine к тебе. А чтобы открывали TrustLines к тебе, ты сам должен быть активным участником сети — покупать, продавать, открывать TrustLines другим.

**Механизм скрытого демереджа работает так:**

1. **Чтобы получать платежи** — нужно, чтобы к тебе были открыты TrustLines (входящий лимит)
2. **Чтобы к тебе открывали TrustLines** — ты должен быть известен, надёжен, полезен сети
3. **Чтобы быть полезным сети** — нужно самому открывать TrustLines (принимать риск), участвовать в клиринге, быть посредником
4. **Открытие TrustLine = риск** — ты можешь потерять до суммы лимита, если должник не вернёт
5. **Результат:** Чем больше хочешь «накопить», тем больше риска должен принять

**Сравнение с традиционными деньгами:**

| Аспект | Традиционные деньги | GEO |
|--------|---------------------|-----|
| Накопление | Можно копить бесконечно | Ограничено TrustLines к тебе |
| Риск накопителя | Только инфляция | Риск невозврата долгов |
| Стимул тратить | Только инфляция | Блокировка входящих платежей при высоком балансе |
| Пассивный доход | Проценты на депозит | Нет — только активное участие |

#### Механизм скрытого демереджа

```
┌────────────────────────────────────────────────────────────┐
│              Скрытый демередж в GEO                        │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  Увеличение TrustLine = Увеличение личного риска          │
│                                                            │
│  Если я открываю TrustLine на 1000 UAH:                   │
│  • Я принимаю риск, что мне не вернут до 1000 UAH        │
│  • Это "цена" за возможность участвовать в сети          │
│  • Больше доверия = больше риска = скрытая "плата"       │
│                                                            │
│  Результат:                                                │
│  • Естественное ограничение накопления "богатства"        │
│  • Стимул к балансировке позиций                         │
│  • Циркуляция вместо накопления                          │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

### 9.2. Стимулы к нулевому балансу

Оптимальная стратегия участника — **стремиться к нулевому балансу**.

#### Последствия положительного баланса (много должны тебе)

| Эффект | Описание |
|--------|----------|
| **Блокировка ликвидности** | TrustLines к тебе использованы на 100% — тебе не могут платить |
| **Снижение полезности** | Участник "выпадает" из сети как получатель |
| **Репутационные последствия** | Воспринимается как "накопитель" |
| **Риск невозврата** | Накопленные долги могут не погаситься |

#### Последствия отрицательного баланса (ты много должен)

| Эффект | Описание |
|--------|----------|
| **Ограничение покупок** | Нет свободного кредита для новых покупок |
| **Риск отзыва TrustLines** | Кредиторы могут закрыть линии |
| **Репутационные последствия** | Снижение доверия к участнику |
| **Необходимость погашения** | Давление предоставить товары/услуги |

#### Оптимальное состояние — около нуля

```
┌────────────────────────────────────────────────────────────┐
│                  Баланс около нуля                         │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ✓ Максимальная гибкость для покупок И продаж            │
│  ✓ Хорошая репутация в сообществе                         │
│  ✓ Стабильные отношения с контрагентами                   │
│  ✓ Минимальные риски                                      │
│  ✓ Активное участие в клиринге                           │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

### 9.3. Метрики экономического здоровья

Для оценки экономического здоровья участника используются четыре ключевые метрики:

1. **Чистый баланс (net_balance)** — разница между тем, сколько должны участнику, и тем, сколько должен он. Идеальное значение — около нуля.

2. **Отклонение от нуля (balance_deviation)** — абсолютное значение чистого баланса. Чем меньше — тем лучше.

3. **Загрузка входящих TrustLines** — какой процент кредитных лимитов, открытых К участнику, использован (долги ему). Если 100% — ему уже не могут платить.

4. **Загрузка исходящих TrustLines** — какой процент лимитов, открытых ОТ участника, использован (его долги). Если 100% — он не может покупать.

**Расчёт скора здоровья (0-100):**
- Начинаем со 100 баллов
- Вычитаем штраф за отклонение от нуля (до 50 баллов)
- Вычитаем штраф за загрузку выше 70% (до 30 баллов)

```python
class EconomicHealthMetrics:
    """Метрики экономического здоровья участника"""
    
    # Чистый баланс (должны тебе - ты должен)
    net_balance: Decimal
    
    # Насколько близок к нулю (0 = идеально)
    balance_deviation: Decimal = abs(net_balance)
    
    # Загрузка входящих TrustLines (%)
    incoming_utilization: Decimal  # debt_to_me / total_incoming_limit
    
    # Загрузка исходящих TrustLines (%)
    outgoing_utilization: Decimal  # my_debt / total_outgoing_limit
    
    # Здоровье баланса (0-100)
    @property
    def health_score(self) -> int:
        # Штраф за отклонение от нуля
        balance_penalty = min(self.balance_deviation / 1000, 50)
        
        # Штраф за высокую загрузку
        utilization_penalty = max(
            self.incoming_utilization - 0.7,
            self.outgoing_utilization - 0.7,
            0
        ) * 100
        
        return max(0, 100 - balance_penalty - utilization_penalty)
```

### 9.4. Алгоритм оценки экономического поведения

Анализ экономического поведения оценивает, насколько участник следует оптимальной стратегии — стремлению к нулевому балансу.

**Алгоритм анализа:**

1. **Сбор истории** — получаем все записи баланса участника за период (по умолчанию 30 дней)
2. **Расчёт среднего баланса** — если он далёк от нуля, это плохой знак
3. **Расчёт волатильности** — слишком стабильный большой баланс хуже, чем колебания вокруг нуля
4. **Определение тренда** — движется ли участник к нулю или от него
5. **Подсчёт участия в клиринге** — активные участники клиринга получают бонус

**Расчёт итогового скора (0-100):**
- Базовые 100 баллов
- Штраф до 30 баллов за большой средний баланс
- Штраф 20 баллов за тренд от нуля, или бонус 10 за тренд к нулю
- Бонус до 20 баллов за активное участие в клиринге

```python
class EconomicBehaviorAnalyzer:
    """Анализатор экономического поведения участника"""
    
    async def analyze_participant(
        self,
        pid: str,
        period_days: int = 30
    ) -> BehaviorAnalysis:
        """
        Анализ экономического поведения.
        
        Оценивает, насколько участник следует оптимальной стратегии
        (стремление к нулевому балансу).
        """
        # Получить историю балансов
        balance_history = await self.get_balance_history(pid, period_days)
        
        # Средний баланс за период
        avg_balance = sum(b.net_balance for b in balance_history) / len(balance_history)
        
        # Волатильность баланса
        balance_volatility = statistics.stdev(
            b.net_balance for b in balance_history
        )
        
        # Тренд (движется к нулю или от нуля?)
        trend = self.calculate_trend(balance_history)
        
        # Частота клиринга
        clearing_participation = await self.count_clearings(pid, period_days)
        
        return BehaviorAnalysis(
            pid=pid,
            avg_balance=avg_balance,
            balance_volatility=balance_volatility,
            trend_direction=trend,  # "toward_zero" | "away_from_zero" | "stable"
            clearing_participation=clearing_participation,
            behavior_score=self.calculate_score(avg_balance, trend, clearing_participation)
        )
    
    def calculate_score(
        self,
        avg_balance: Decimal,
        trend: str,
        clearing_count: int
    ) -> int:
        """
        Скор поведения (0-100).
        
        Высокий скор = хорошее экономическое поведение.
        """
        score = 100
        
        # Штраф за большой средний баланс
        score -= min(abs(avg_balance) / 100, 30)
        
        # Штраф за движение от нуля
        if trend == "away_from_zero":
            score -= 20
        elif trend == "toward_zero":
            score += 10
        
        # Бонус за участие в клиринге
        score += min(clearing_count * 2, 20)
        
        return max(0, min(100, score))
```

---

## 10. Репутационная система

### 10.1. Назначение

Репутация в GEO отражает **надёжность и полезность** участника для сети.

### 10.2. Компоненты репутации

Репутационный скор участника складывается из четырёх групп метрик:

**1. Базовые метрики доверия:**
- Общая сумма лимитов TrustLines, открытых К участнику (сколько ему доверяют в деньгах)
- Количество разных участников, которые ему доверяют (широта доверия)

**2. Метрики активности:**
- Сколько платежей отправил и получил участник
- Процент успешных платежей (не абортированных)

**3. Метрики экономического поведения:**
- Как часто участвует в клиринге (помогает сети)
- Насколько близок его баланс к нулю (здоровое поведение)

**4. Метрики вклада в сеть:**
- Сколько раз был посредником в платежах других участников
- Какой объём прошёл через него (ценность для сети)

**5. Верификация и стаж:**
- Уровень верификации личности (0-3)
- Как давно состоит в сообществе

```python
class ReputationScore:
    """Репутационный скор участника"""
    
    # === Базовые метрики ===
    
    # Сумма входящих TrustLines (сколько доверяют участнику)
    trust_received: Decimal
    
    # Количество участников, открывших TrustLine к нему
    trustees_count: int
    
    # === Метрики активности ===
    
    # Количество успешных платежей (отправленных)
    payments_sent: int
    
    # Количество полученных платежей
    payments_received: int
    
    # Успешность платежей (% COMMITTED от всех инициированных)
    payment_success_rate: Decimal
    
    # === Метрики экономического поведения ===
    
    # Участие в клиринге (сколько раз участвовал)
    clearing_participation: int
    
    # Средний баланс (близость к нулю)
    avg_balance_deviation: Decimal
    
    # === Метрики вклада в сеть ===
    
    # Сколько раз был посредником в платежах
    intermediary_count: int
    
    # Объём "прокачанных" через себя платежей
    intermediary_volume: Decimal
    
    # === Верификация ===
    
    # Уровень верификации (0-3)
    verification_level: int
    
    # Длительность членства в сообществе
    member_since: datetime
```

### 10.3. Алгоритм расчёта репутации

Репутационный скор — это число от 0 до 100, которое рассчитывается как взвешенная сумма нормализованных метрик.

**Веса компонентов:**
- **Полученное доверие (20%)** — сколько суммарно тебе доверяют в деньгах
- **Количество доверителей (10%)** — сколько разных людей тебе доверяют
- **Успешность платежей (15%)** — какой процент платежей прошёл успешно
- **Участие в клиринге (10%)** — как часто участвуешь в взаимозачёте
- **Здоровье баланса (15%)** — насколько баланс близок к нулю
- **Вклад в сеть (15%)** — сколько платежей прокачал как посредник
- **Верификация (10%)** — уровень подтверждения личности
- **Стаж (5%)** — как давно в сообществе

**Нормализация метрик:**
- Каждая метрика приводится к шкале 0-100
- Для денежных сумм используется логарифмическая шкала (1000 = ~50, 10000 = ~80)
- Для количества — линейная с насыщением (например, 50 доверителей = 100)
- Для стажа — 1 год = 100 баллов

**Итоговый расчёт:**
```
score = Σ (normalized[i] × weight[i])
```

```python
class ReputationService:
    """Сервис расчёта репутации"""
    
    # Веса компонентов
    WEIGHTS = {
        "trust_received": 0.20,       # 20%
        "trustees_count": 0.10,       # 10%
        "payment_success": 0.15,      # 15%
        "clearing_participation": 0.10, # 10%
        "balance_health": 0.15,       # 15%
        "network_contribution": 0.15, # 15%
        "verification": 0.10,         # 10%
        "tenure": 0.05                # 5%
    }
    
    async def calculate_reputation(
        self,
        pid: str
    ) -> ReputationResult:
        """
        Рассчитать репутационный скор (0-100).
        """
        metrics = await self.gather_metrics(pid)
        
        # Нормализовать каждую метрику к 0-100
        normalized = {
            "trust_received": self.normalize_trust(metrics.trust_received),
            "trustees_count": self.normalize_count(metrics.trustees_count, max_expected=50),
            "payment_success": metrics.payment_success_rate * 100,
            "clearing_participation": self.normalize_count(metrics.clearing_participation, max_expected=100),
            "balance_health": 100 - min(metrics.avg_balance_deviation / 10, 100),
            "network_contribution": self.normalize_contribution(metrics.intermediary_volume),
            "verification": metrics.verification_level * 33.33,
            "tenure": self.normalize_tenure(metrics.member_since)
        }
        
        # Взвешенная сумма
        total_score = sum(
            normalized[key] * weight
            for key, weight in self.WEIGHTS.items()
        )
        
        return ReputationResult(
            pid=pid,
            score=round(total_score),
            breakdown=normalized,
            calculated_at=datetime.utcnow()
        )
    
    def normalize_trust(self, trust_received: Decimal) -> Decimal:
        """
        Нормализация полученного доверия.
        
        Логарифмическая шкала (1000 UAH = ~50, 10000 = ~80, 100000 = ~100)
        """
        if trust_received <= 0:
            return Decimal("0")
        
        import math
        return min(100, Decimal(math.log10(float(trust_received) + 1) * 25))
    
    def normalize_contribution(self, volume: Decimal) -> Decimal:
        """Нормализация вклада как посредника"""
        if volume <= 0:
            return Decimal("0")
        
        import math
        return min(100, Decimal(math.log10(float(volume) + 1) * 20))
    
    def normalize_tenure(self, member_since: datetime) -> Decimal:
        """Нормализация срока членства"""
        days = (datetime.utcnow() - member_since).days
        
        # 1 год = 100
        return min(100, Decimal(days / 365 * 100))
```

### 10.4. Использование репутации

| Контекст | Как используется |
|----------|------------------|
| **Открытие TrustLine** | Рекомендация лимита на основе репутации получателя |
| **Маршрутизация** | Предпочтение путей через высокорепутационных посредников |
| **Фильтрация спама** | Минимальная репутация для связи с участником |
| **Разрешение споров** | Учёт репутации при арбитраже |
| **Gateway** | Минимальная репутация для регистрации Gateway |

### 10.5. API репутации

```python
# Endpoint: GET /api/v1/participants/{pid}/reputation

{
  "pid": "5HueCGU8rMjx...",
  "score": 78,
  "level": "trusted",  # "new" | "basic" | "trusted" | "established" | "pillar"
  "breakdown": {
    "trust_received": 85,
    "trustees_count": 60,
    "payment_success": 95,
    "clearing_participation": 70,
    "balance_health": 80,
    "network_contribution": 65,
    "verification": 66,
    "tenure": 40
  },
  "badges": ["active_trader", "good_intermediary", "clearing_champion"],
  "calculated_at": "2025-11-30T12:00:00Z"
}
```

### 10.6. Уровни репутации

| Уровень | Скор | Описание |
|---------|------|----------|
| `new` | 0-20 | Новый участник, ограниченные возможности |
| `basic` | 21-40 | Базовый участник, стандартные возможности |
| `trusted` | 41-60 | Доверенный, расширенные лимиты |
| `established` | 61-80 | Устоявшийся, может быть Gateway |
| `pillar` | 81-100 | Столп сообщества, максимальные привилегии |

---

## Глоссарий

| Термин | Определение |
|--------|-------------|
| **PID** | Participant ID — идентификатор участника |
| **TrustLine** | Линия доверия — кредитный лимит от A к B |
| **Debt** | Долг — фактическое обязательство |
| **Equivalent** | Эквивалент — единица счёта |
| **Available Credit** | Доступный кредит — остаток лимита минус долг |
| **Clearing** | Клиринг — взаимозачёт долгов по циклу |
| **2PC** | Two-Phase Commit — двухфазный коммит |
| **Hub** | Узел сообщества — координатор и хранилище |
| **Demurrage** | Демередж — "плата" за хранение средств |
| **Reputation** | Репутация — мера надёжности участника |

---

## Связанные документы

- [00-overview.md](00-overview.md) — Обзор проекта
- [02-protocol-spec.md](02-protocol-spec.md) — Полная спецификация протокола
- [03-architecture.md](03-architecture.md) — Архитектура системы
