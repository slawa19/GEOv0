
# Стек для игрового интерфейса симулятора GEO (Финальный)

Этот документ фиксирует технологический выбор для разработки модуля "Симулятор" — интерактивной карты сообщества и визуализации клиринга долговых обязательств.

---

## 1. Базовые принципы выбора
1.  **Единство экосистемы:** Использование Vue.js 3 обеспечивает переиспользование логики и компонентов из Админки и PWA клиента.
2.  **Производительность:** Прямая работа с Canvas (через `force-graph`) вместо тяжелых DOM-манипуляций.
3.  **Атмосферность:** Упор на кастомную графику, частицы и звук для создания эффекта "живой системы".

---

## 2. Frontend Framework & Core

| Компонент | Технология | Обоснование |
| :--- | :--- | :--- |
| **Framework** | **Vue.js 3** (Composition API) | Основной стандарт проекта. Composition API идеально подходит для сложной логики симуляции и физики. |
| **Build Tool** | **Vite** | Максимальная скорость сборки, горячая перезагрузка (HMR). |
| **Language** | **TypeScript** | Строгая типизация узлов графа (Node) и связей (Link) критична для стабильности математической модели. |
| **State Management** | **Pinia** | Управление глобальным состоянием: выбранный узел, режим клиринга, загруженные данные. |

---

## 3. Визуализация Графа (Graph Engine)

| Компонент | Технология | Обоснование |
| :--- | :--- | :--- |
| **Core Engine** | **force-graph** | Нативная библиотека (Vanilla JS) на базе HTML5 Canvas. Обеспечивает рендеринг 100+ узлов без лагов. Легко интегрируется в Vue через `ref` и `onMounted`. |
| **Physics** | **d3-force** (встроено) | Физический движок для симуляции притяжения и отталкивания узлов. |

*Пример использования во Vue:*
```typescript
import ForceGraph from 'force-graph';
// Инициализация напрямую в DOM-элемент без лишних React-оберток
const myGraph = ForceGraph()(document.getElementById('graph'))
    .graphData(myData)
    .nodeCanvasObject((node, ctx) => { ... }); 
```

---

## 4. UI/UX и Стилизация

| Компонент | Технология | Обоснование |
| :--- | :--- | :--- |
| **Styling** | **Tailwind CSS** | Утилитарный подход позволяет быстро создавать "стеклянные" панели (backdrop-blur), неоновые свечения и сложные сетки без борьбы со стилями UI-библиотек. |
| **Icons** | **Lucide Vue** | Легкие, современные векторные иконки. Единый стиль с админкой. |
| **Animations** | **Vue Transition** | Нативная система переходов Vue для плавного появления/исчезновения UI-элементов (карточек, кнопок). |

---

## 5. Интерактивность и Эффекты (Immersion)

| Компонент | Технология | Обоснование |
| :--- | :--- | :--- |
| **Audio** | **Howler.js** | Профессиональная работа со звуком. Позволяет накладывать слои (фоновый эмбиент + звуковые эффекты клиринга/кликов). |
| **Particles** | **tsparticles** (версия `slim` + `@tsparticles/vue3`) | Легковесная симуляция "звездной пыли" на заднем плане для создания глубины сцены. |

---

## 6. Интеграция с Backend (Python)

Модуль симулятора работает как клиентское SPA, получающее данные от FastAPI.

| Тип взаимодействия | Метод | Описание |
| :--- | :--- | :--- |
| **Загрузка данных** | REST API (`GET /graph/snapshot`) | Получение полного слепка графа (узлы + связи + балансы) при инициализации. |
| **Симуляция** | Client-side | Расчет позиций узлов происходит в браузере. Сервер не нагружается физикой. |
| **Действия** | REST API (`POST /clearing/trigger`) | Отправка команды на запуск клиринга (если это админский режим) или получение истории транзакций. |

---

## 7. Сводная таблица стека (Summary)

```json
{
  "project": "GEO Simulator UI",
  "core": {
    "framework": "Vue.js 3",
    "language": "TypeScript",
    "store": "Pinia",
    "build": "Vite"
  },
  "visuals": {
    "graph": "force-graph",
    "styles": "Tailwind CSS",
    "icons": "lucide-vue-next"
  },
  "immersion": {
    "audio": "howler",
    "particles": "@tsparticles/vue3"
  }
}
```
