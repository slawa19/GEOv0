# GEO Simulator v2 — Расхождения код vs спецификация

**Дата:** 2026-01-27  
**Статус:** Информационный документ

**Обновление (2026-01-27):** раздел 6.3 в [GEO-visual-demo-fast-mock.md](GEO-visual-demo-fast-mock.md) синхронизирован с `vizMapping.ts`, текущих расхождений по значениям `link.width_px` / `link.alpha` больше нет. Также реализовано влияние `intensity_key` на интенсивность FX (sparks / edge pulses). Ниже сохранена историческая справка о том, какие значения были в ранней версии спеки.

Этот документ фиксирует известные расхождения между спецификацией и реализацией, которые являются **намеренными** (оптимизация по результатам тестирования визуала).

---

## 1. Значения link.width_px

| Ключ | Спека (до 2026-01-27) | Реализация | Причина |
|------|-------------|------------|---------|
| hairline | 0.6 | 0.6 | ✅ совпадает |
| thin | 1.0 | 0.9 | Тоньше для меньшего визуального шума |
| mid | 1.8 | 1.1 | Тоньше для меньшего визуального шума |
| thick | 2.6 | 1.25 | Тоньше для меньшего визуального шума |
| highlight | 2.4 | 2.2 | Незначительное уменьшение |

**Обоснование:** При 100+ рёбрах оригинальные значения создавали "шерсть". Текущие значения дают чистую читаемость при сохранении визуальной иерархии.

---

## 2. Значения link.alpha

| Ключ | Спека (до 2026-01-27) | Реализация | Причина |
|------|-------------|------------|---------|
| bg | 0.10 | 0.06 | Менее навязчивый фон |
| muted | 0.22 | 0.12 | Меньше контраст для muted рёбер |
| active | 0.45 | 0.20 | Активные рёбра не перекрывают узлы |
| hi | 0.85 | 0.32 | Highlight не "засвечивает" весь граф |

**Обоснование:** Оригинальные значения alpha были рассчитаны для светлого фона. На тёмном фоне (#020617) они создавали избыточную яркость. Текущие значения оптимизированы для "космического" визуала.

---

## 3. Нереализованные элементы спецификации

### Реализовать не планируется (по решению)

| Элемент | Причина пропуска |
|---------|------------------|
| /graph/ego endpoint | Fixture-first демо не требует |
| SSE events streaming | Fixture-first демо не требует |
| Фон tsparticles | Overengineering для демо |
| flash в clearing.plan | Node bursts лучше по UX |

### Отложено до следующего этапа

| Элемент | Условие реализации |
|---------|-------------------|
| palette в snapshot | При добавлении легенды |
| limits в snapshot | При работе с большими графами (>300 узлов) |
| viz_badge_key | При необходимости статических бейджей |

**Примечание:** `intensity_key` → интенсивность FX уже реализовано (2026-01-27), поэтому пункт убран из backlog.

---

## 4. Рекомендация

При обновлении спецификации GEO-visual-demo-fast-mock.md раздел 6.3 следует либо:
1. Обновить JSON на актуальные значения из vizMapping.ts
2. Добавить примечание "значения ориентировочные, SoT — код"

Текущий подход: **код является SoT**, документация — ориентир. На текущий момент (2026-01-27) значения в спеке 6.3 уже совпадают с кодом.
